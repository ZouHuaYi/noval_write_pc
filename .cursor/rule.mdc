---
alwaysApply: true
---
## 二、技术栈与目录约定

- **前端框架**
  - 使用 `Vue 3` 组合式 API（`<script setup>` 为主），构建工具为 `Vite`。
  - 样式框架采用 `Tailwind CSS`，公共样式位于 `src/assets/tailwind.css`。

- **主要目录**
  - `src/App.vue`：应用主界面与核心逻辑文件，体量较大，修改时需谨慎、聚焦。
  - `src/components/`：公用组件，新增通用界面或弹窗时优先放入此目录并复用。
  - `electron/`：Electron 主进程相关代码（`main.js`、`preload.js`、`llm.js`、`database.js`），涉及启动流程、窗口管理、本地数据库与模型调用。
  - `dist/`、`release/`：构建产物与打包结果，**禁止直接修改**，仅作为调试参考。

---

## 三、代码风格规范

- **通用规范**
  - 使用 **ES2020+** 语法，避免使用已废弃或不推荐的特性。
  - 变量与函数命名使用 **小驼峰**（`camelCase`），类名与组件名使用 **大驼峰**（`PascalCase`）。
  - 禁止出现未使用的变量、参数与导入；若为暂留代码，请使用明确注释标注原因。

- **Vue / 组件规范**
  - 新组件文件命名采用 `PascalCase`，例如：`ChatPanel.vue`、`SettingsDialog.vue`。
  - 优先使用 `<script setup lang="ts">` 与组合式 API；若需要选项式 API，需在文件顶部注明原因。
  - 组件间通过 `props`/`emits` 进行通信，避免滥用全局事件总线或在无必要时引入复杂状态管理。
  - 模板中逻辑应尽量保持简单，将复杂逻辑抽离到 `computed`、`methods` 或独立工具函数中。
  - 在 `App.vue` 中新增复杂逻辑时，优先考虑拆分为独立组件后引入，减少主文件复杂度。

- **样式与布局**
  - 优先使用 `Tailwind CSS` 工具类进行布局和常规样式控制。
  - 仅在 Tailwind 无法满足需求时，才在单文件组件中使用 `<style scoped>` 编写局部样式。
  - 避免在多个组件中重复粘贴相同样式，考虑抽象为公共类或公用组件。

- **Electron / Node 侧规范**
  - `electron/main.js` 只负责应用生命周期与窗口管理，具体业务逻辑尽量拆分到单独模块（如 `llm.js`、`database.js`）。
  - 进程间通信（`ipcMain` / `ipcRenderer`）的 `channel` 名称保持语义清晰，并集中管理，避免魔法字符串散落各处。
  - 涉及文件系统、数据库或本地模型访问时，需要做好错误捕获与日志记录，避免导致主进程崩溃。

---

## 四、类型与错误处理

- **类型（若使用 TS）**
  - `src/main.ts` 与新建逻辑文件中，尽量为函数入参、返回值、复杂对象补充类型声明。
  - 避免滥用 `any` 类型；如确有需要，应在附近增加注释解释原因。

- **错误处理与日志**
  - 对 `await` 调用增加 `try/catch` 捕获，至少输出可定位问题的错误信息（建议通过统一日志函数或控制台输出）。
  - 对涉及本地文件、数据库操作等高风险逻辑，需考虑失败场景并给出用户友好的提示（如对话框提示）。

---

## 五、注释与文档

- **注释要求**
  - 对于复杂逻辑、关键算法、涉及业务规则的代码块，必须添加简明中文注释。
  - 临时代码、兼容处理或待优化部分，使用 `// TODO: ...` 或 `// FIXME: ...` 说明。

## 六、依赖与构建

- **依赖管理**
  - 使用 `npm` 管理依赖，新增依赖时需确保为 **生产必须** 或 **对开发具有明显价值**。
  - 避免引入体积过大或功能重复的第三方库；若存在替代方案，优先选择与现有栈兼容度高的。

- **构建与打包**
  - 保持 `vite.config.mts`、`tailwind.config.cjs` 的配置简洁、可读，新增配置前评估是否必要。
  - Electron 打包配置位于 `build/` 与 `release/` 相关文件中，如需调整打包行为，应保证不影响现有发布流程。

---

## 七、与 Cursor AI 的交互约定

- **工具使用**
  - 在需要修改代码时，可以主动使用 `apply_patch` 工具进行精确编辑，避免生成整文件覆盖。
  - 在分析问题或定位逻辑时，可使用 `read_file`、`grep` 等工具阅读代码，但应避免无目的的大范围扫描。

- **回答风格**
  - 对用户的解释说明应简明、结构清晰，优先使用分级标题与列表。
  - 当进行较大范围修改时，应在回答末尾给出简短的变更概要，方便用户理解改动内容。

---

## 八、其他约定

- 禁止在仓库中加入大体积二进制文件（除非是构建产物目录中自动生成）。
- 若某处存在与以上规范不一致但又暂时无法调整的旧代码，修改时以 **行为不变** 为前提逐步优化，避免一次性重构造成风险。


